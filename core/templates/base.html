<!DOCTYPE html>
<html lang="{{ lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>InsightZen - {% block title %}Dashboard{% endblock %}</title>
    {% load static custom_tags %}
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Vazirmatn:wght@400;500;600&display=swap">
    <link rel="stylesheet" href="{% static 'core/css/styles.css' %}">
    {# Custom dark theme overrides #}
    <link rel="stylesheet" href="{% static 'core/css/theme.css' %}">
</head>
<body class="{% if lang == 'fa' %}rtl{% else %}ltr{% endif %}">
    <div class="wrapper">
        <aside class="sidebar" id="sidebar">
            {% render_sidebar %}
        </aside>
        <div class="main">
            <header class="header">
                <button id="menu-toggle" class="menu-toggle" aria-label="Toggle menu">
                    <i data-feather="menu"></i>
                </button>
                <div class="brand">
                    <img src="{% static 'core/logo.png' %}" alt="InsightZen Logo" class="logo">
                    <span class="brand-name">InsightZen</span>
                </div>
                <div class="top-actions">
                    {% if lang == 'fa' %}
                        <a class="lang-btn" href="{% url 'toggle_language' 'en' %}">English</a>
                    {% else %}
                        <a class="lang-btn" href="{% url 'toggle_language' 'fa' %}">فارسی</a>
                    {% endif %}
                    {% if user.is_authenticated %}
                        <a class="btn btn-outline btn-sm" href="{% url 'logout' %}">
                            {% if lang == 'fa' %}خروج{% else %}Logout{% endif %}
                        </a>
                    {% endif %}
                </div>
            </header>
            <div class="page-content">
                {% for message in messages %}
                    <div class="alert alert-{{ message.tags }}">{{ message }}</div>
                {% endfor %}
                {% block content %}{% endblock %}
            </div>
        </div>
    </div>
    <template id="table-advanced-filter-template">
        <div class="table-advanced-filter" role="dialog" aria-modal="true" data-table-advanced-root hidden>
            <div class="table-advanced-filter__backdrop" data-advanced-dismiss="true"></div>
            <div class="table-advanced-filter__panel" role="document">
                <header class="table-advanced-filter__header">
                    <h2 class="table-advanced-filter__title" data-i18n="title"></h2>
                    <button type="button" class="table-advanced-filter__close" data-advanced-dismiss="true" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </header>
                <div class="table-advanced-filter__body">
                    <p class="table-advanced-filter__hint" data-i18n="hint"></p>
                    <div class="table-advanced-filter__logic">
                        <label>
                            <span data-i18n="logicLabel"></span>
                            <select data-advanced-logic></select>
                        </label>
                    </div>
                    <div class="table-advanced-filter__saved" data-advanced-saved hidden>
                        <p class="table-advanced-filter__saved-text" data-i18n="savedInfo"></p>
                        <div class="table-advanced-filter__saved-actions">
                            <button type="button" class="btn btn-sm btn-secondary" data-advanced-load></button>
                            <button type="button" class="btn btn-sm btn-outline" data-advanced-clear-saved></button>
                        </div>
                    </div>
                    <div class="table-advanced-filter__status" data-advanced-status role="status" aria-live="polite"></div>
                    <div class="table-advanced-filter__conditions" data-advanced-conditions></div>
                    <button type="button" class="btn btn-sm table-advanced-filter__add" data-advanced-add></button>
                    <label class="table-advanced-filter__remember">
                        <input type="checkbox" data-advanced-remember>
                        <span data-i18n="remember"></span>
                    </label>
                </div>
                <footer class="table-advanced-filter__footer">
                    <button type="button" class="btn btn-primary" data-advanced-apply></button>
                    <button type="button" class="btn btn-outline" data-advanced-reset></button>
                    <button type="button" class="btn btn-text" data-advanced-cancel></button>
                </footer>
            </div>
        </div>
    </template>
    {% block extra_scripts %}{% endblock %}
    <script src="{% static 'core/js/scripts.js' %}"></script>
    <script src="{% static 'core/js/table.js' %}"></script>
    {# Chart.js from CDN for interactive charts #}
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js" integrity="sha384-V0nLmCBeWWog78ZFPUtAN0hYdR4P9J66yUfXJy3FxjsNuEzsAnfOq3+9Ky2i7c+5" crossorigin="anonymous"></script>
    {# Custom UI interactions: sidebar persistence and accordion behaviour #}
    <script src="{% static 'core/js/ui.js' %}"></script>
    {# Feather icons: convert data-feather attributes to inline SVGs #}
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js" integrity="sha384-V4U6DN1s6pXZJAGmKkd9/CS7v4v7z3tMTVh+EJkSw9b463Uc0kzgTVI5AQ1eFI3K" crossorigin="anonymous"></script>
    <script>feather.replace({ strokeWidth: 1.4 });</script>
</body>
</html>